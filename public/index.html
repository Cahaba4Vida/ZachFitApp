<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0f172a" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <title>Fit Hub - Access</title>
    <link rel="stylesheet" href="/styles.css" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="icon" href="/icon.svg" type="image/svg+xml" />
  </head>
  <body class="page">
    <main class="card">
      <h1>Fit Hub</h1>
      <p class="muted">Enter the admin token to access the leader dashboard.</p>
      <label class="field">
        <span>Admin Token</span>
        <input
          id="token-input"
          type="password"
          placeholder="Paste ADMIN_AUTH_TOKEN"
        />
      </label>
      <label class="field">
        <span>Actor</span>
        <select id="actor-select">
          <option value="Braxton">Braxton</option>
          <option value="Brannon">Brannon</option>
          <option value="Asher">Asher</option>
          <option value="Danny">Danny</option>
        </select>
      </label>
      <button id="enter-button" class="primary" type="button">Enter</button>
      <p id="error" class="error"></p>
    </main>
    <footer class="app-footer">
      <span>Â© Designed by zachedwardsllc</span>
    </footer>

    <script>
      const tokenInput = document.getElementById("token-input");
      const actorSelect = document.getElementById("actor-select");
      const enterButton = document.getElementById("enter-button");
      const error = document.getElementById("error");

      const flash = sessionStorage.getItem("fitHubFlash");
      if (flash) {
        error.textContent = flash;
        error.style.display = "block";
        sessionStorage.removeItem("fitHubFlash");
      }

      const existingToken = localStorage.getItem("fitHubAdminToken");
      const existingActor = localStorage.getItem("fitHubActor");

      if (existingToken) {
        window.location.href = "/app.html";
      }

      if (existingActor) {
        actorSelect.value = existingActor;
      }

      enterButton.addEventListener("click", () => {
        const token = tokenInput.value.trim();
        const actor = actorSelect.value;

        if (!token) {
          error.textContent = "Admin token is required.";
          return;
        }

        localStorage.setItem("fitHubAdminToken", token);
        localStorage.setItem("fitHubActor", actor);
        window.location.href = "/app.html";
      });
    </script>
  </body>
</html>
